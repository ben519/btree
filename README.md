# btree
binary tree structures as data.table objects

About
------
The goals of this package are

- Easy of generation binary tree structures as data.table objects
- Measure binary tree structure properties (e.g. height, path to node, etc.)
- Easy plotting of binary trees

The original intent of the package was to make it easy to standardize and analyze tree data generated by various tree-based machine learning packages in R.


Installation
------

#### Github (development version)
```r
install.packages("devtools")

library(devtools)
install_github("ben519/btree")
```
---

## What is a btree?

For our purposes, it's a data.table with the following structure

- Each row represents a node in the tree and is uniquely identified by NodeID
- Each row contains a ParentNodeID which points at the node's parent. (The root node has ParentID = NA)

Using the `make_btree(...)` constructor generates a LeftChildID and RightChildID (NA for leaf nodes) in addition to NodeID and ParentNodeID.

### Decision Tree / Regression Tree

A btree can also be a decision tree / regression tree where

- Each non-leaf node must contain a decision rule determining how to split the data
- Rules are represents by the attribute ConditionLeft, such that evaluating to TRUE sends a point to the left child node
- E.g. ConditionLeft could be "Petal.Length <= 2.35" or in the case of xgboost, "Petal.Length <= 2.35 | is.na(Petal.Length)"

Demonstration
------

```r
library(data.table)
library(btree)

make_btree(nodeIDs=c(1,2,3,4,5,6,7), parentNodeIDs=c(NA,1,1,2,2,3,3))
   NodeID ParentNodeID LeftChildNodeID RightChildNodeID
1:      1           NA               2                3
2:      2            1               4                5
3:      3            1               6                7
4:      4            2              NA               NA
5:      5            2              NA               NA
6:      6            3              NA               NA
7:      7            3              NA               NA

make_btree(nodeIDs=c(1,2,3), leftChildIDs=c(2,NA,NA), rightChildIDs=c(3,NA,NA))
   NodeID ParentNodeID LeftChildNodeID RightChildNodeID
1:      1           NA               2                3
2:      2            1              NA               NA
3:      3            1              NA               NA

mytree <- make_perfect_btree(height=2)
mytree
   NodeID ParentNodeID LeftChildNodeID RightChildNodeID
1:      1           NA               2                3
2:      2            1               4                5
3:      3            1               6                7
4:      4            2              NA               NA
5:      5            2              NA               NA
6:      6            3              NA               NA
7:      7            3              NA               NA

sub_btree(mytree, nodeID=2)
   NodeID ParentNodeID LeftChildNodeID RightChildNodeID
1:      2           NA               4                5
2:      4            2              NA               NA
3:      5            2              NA               NA

class(mytree)  # "data.table" "data.frame"
```

## TODO
- Implement code for handling factors in a dtree
- Implement samples_at_node(dtree, nodeId)
- Implement predict(dtree, data)
- Possible speed improvement for dtree_node_conditions by retaining path to each node as NodeIds or indices instead of LRLR to prevent looping over each depth
- Create btreeforest and dtreeforest classes?

## Contact
If you'd like to contact me regarding bugs, questions, or general consulting, feel free to drop me a line - bgorman519@gmail.com
